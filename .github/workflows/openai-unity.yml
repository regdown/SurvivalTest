name: OpenAI Unity Automation

on:
  workflow_dispatch:
    inputs:
      task:
        description: '–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ –¥–ª—è GPT'
        required: true
        type: string

jobs:
  automate-task:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          ref: main

      - name: Generate changes with GPT
        id: gpt
        uses: openai/openai-action@v1
        env:
          OPENAI_API_KEY: ${{ secrets.GPT_PUSH_TOKEN }}
        with:
          model: 'gpt-4o'
          prompt: |
            –¢—ã ‚Äî –ø–æ–º–æ—â–Ω–∏–∫ –ø–æ Unity –∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—é.
            –í—ã–ø–æ–ª–Ω–∏ —Å–ª–µ–¥—É—é—â—É—é –∑–∞–¥–∞—á—É –≤ Unity-–ø—Ä–æ–µ–∫—Ç–µ:
            "${{ github.event.inputs.task }}"

            –í—ã–¥–∞–π –ø–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏–ª–∏ –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–¥–æ –≤—Å—Ç–∞–≤–∏—Ç—å –≤ –ø—Ä–æ–µ–∫—Ç, –≤ —Ñ–æ—Ä–º–∞—Ç–µ markdown.

      - name: Create file with GPT response
        run: |
          echo "${{ steps.gpt.outputs.response }}" > GPT_Response.md

      - name: Commit changes and create PR
        uses: peter-evans/create-pull-request@v6
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          branch: auto/openai-changes
          title: "ü§ñ GPT Automated changes"
          commit-message: "üõ†Ô∏è –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç GPT"
          body: |
            –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:
            
            - –ó–∞–¥–∞—á–∞: ${{ github.event.inputs.task }}

            –°–º. –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –≤ —Ñ–∞–π–ª–µ [GPT_Response.md].
